filtered_entites = [
    {
        "id": "a60bab83-b8b0-4871-92c2-96006704cd34",
        "name": {
            "languageKeys": ["en-US", "es-BO", "tr-TR"],
            "languageTexts": ["", "Gildaro Jimenez Sarsuza", ""],
        },
        "parentEntityID": "ffe756dc-bb8a-4a4b-af80-e608d477f1f5",
        "level": {"id": "f8eebf42-2869-40a9-afab-0a2f429a98a6"},
        "executedSurveyID": "251be4f9-57c9-45e3-9293-ef8629a6aa85",
    },
    {
        "id": "8699ee31-b9d2-4420-ba3a-249af25fd9d9",
        "name": {
            "languageKeys": ["en-US", "es-BO", "tr-TR"],
            "languageTexts": ["", "Benedicto Mamani Calani", ""],
        },
        "parentEntityID": "ffe756dc-bb8a-4a4b-af80-e608d477f1f5",
        "level": {"id": "f8eebf42-2869-40a9-afab-0a2f429a98a6"},
        "executedSurveyID": "c309edd3-22b7-48c7-987e-9381a54cd6b0",
    },
]


all_entites = [
    {
        "id": "ffe756dc-bb8a-4a4b-af80-e608d477f1f5",
        "name": {
            "languageKeys": ["en-US", "es-BO", "tr-TR"],
            "languageTexts": ["", "Fortunato Orellana Garcia", ""],
        },
        "appliedInterventions": {
            "items": [
                {
                    "executedSurveys": {
                        "items": [
                            {
                                "executedSurveySurveyId": "1334139a-5bd0-4ad3-b17f-c0d608cd6f62",
                                "id": "eab89bb2-eb73-4de3-93c1-c84282db33f8",
                            },
                            {
                                "executedSurveySurveyId": "a16a5ca4-ae84-43d3-b91c-5ba416743064",
                                "id": "23ae1a89-e1db-425d-acf6-aa91e130fcd2",
                            },
                            {
                                "executedSurveySurveyId": "28ee066e-ea32-403c-b733-c9402a798aca",
                                "id": "7429cbb8-0c81-4373-9949-708487dd1eed",
                            },
                        ]
                    }
                }
            ]
        },
        "parentEntityID": "84330145-5754-4eb1-ae6d-c7606ff6f930",
        "level": {"id": "f8eebf42-2869-40a9-afab-0a2f429a98a6"},
    },
    {
        "id": "84330145-5754-4eb1-ae6d-c7606ff6f930",
        "name": {
            "languageKeys": ["en-US", "es-BO", "tr-TR"],
            "languageTexts": ["", "Ejemplo: Familia X", ""],
        },
        "appliedInterventions": {
            "items": [
                {
                    "executedSurveys": {
                        "items": [
                            {
                                "executedSurveySurveyId": "f05f077e-3517-42b4-9aab-343192a6bb2c",
                                "id": "448239a8-a3e0-4de7-a63b-3ec04c54cd69",
                            },
                            {
                                "executedSurveySurveyId": "f05f077e-3517-42b4-9aab-343192a6bb2c",
                                "id": "cf08061c-646e-488b-96c2-91a039aca0ba",
                            },
                            {
                                "executedSurveySurveyId": "169917f1-9142-4c46-b24c-1847ec4f65d2",
                                "id": "7a6dc047-2ae0-4dd2-912e-70261abd8109",
                            },
                            {
                                "executedSurveySurveyId": "169917f1-9142-4c46-b24c-1847ec4f65d2",
                                "id": "553040a5-b740-4a96-be8f-134cd683e5d0",
                            },
                            {
                                "executedSurveySurveyId": "f05f077e-3517-42b4-9aab-343192a6bb2c",
                                "id": "313c8135-1805-417f-bac6-420d50a59218",
                            },
                            {
                                "executedSurveySurveyId": "f05f077e-3517-42b4-9aab-343192a6bb2c",
                                "id": "106de9e4-95e5-4dcb-a260-d9f030d36586",
                            },
                            {
                                "executedSurveySurveyId": "169917f1-9142-4c46-b24c-1847ec4f65d2",
                                "id": "a2d02bb1-39cb-4e65-84f3-e928a39858e4",
                            },
                            {
                                "executedSurveySurveyId": "169917f1-9142-4c46-b24c-1847ec4f65d2",
                                "id": "2ef819c2-0023-4729-86ab-00b1b8b1503b",
                            },
                            {
                                "executedSurveySurveyId": "169917f1-9142-4c46-b24c-1847ec4f65d2",
                                "id": "223adbc5-ff2b-4295-a877-d65a547bad7b",
                            },
                        ]
                    }
                }
            ]
        },
        "parentEntityID": "eafd0500-c34b-40c1-8b23-74e5cbeb28dc",
        "level": {"id": "f8eebf42-2869-40a9-afab-0a2f429a98a6"},
    },
    {
        "id": "asdasdasd",
        "name": {
            "languageKeys": ["en-US", "es-BO", "tr-TR"],
            "languageTexts": ["", "Nemecio Yapura Condori", ""],
        },
        "appliedInterventions": {
            "items": [
                {
                    "executedSurveys": {
                        "items": [
                            {
                                "executedSurveySurveyId": "a16a5ca4-ae84-43d3-b91c-5ba416743064",
                                "id": "59653058-5346-4003-bf94-60732963845c",
                            },
                            {
                                "executedSurveySurveyId": "1334139a-5bd0-4ad3-b17f-c0d608cd6f62",
                                "id": "c004a0c5-6cba-4a56-b29b-374903abb7e4",
                            },
                            {
                                "executedSurveySurveyId": "28ee066e-ea32-403c-b733-c9402a798aca",
                                "id": "c0558795-5304-4cc8-ae36-d0d0aebc53eb",
                            },
                        ]
                    }
                }
            ]
        },
        "parentEntityID": "84330145-5754-4eb1-ae6d-c7606ff6f930",
        "level": {"id": "f8eebf42-2869-40a9-afab-0a2f429a98a6"},
    },
    {
        "id": "459c332e-cc9f-4256-a71a-388897161434",
        "name": {
            "languageKeys": ["en-US", "es-BO", "tr-TR"],
            "languageTexts": ["", "Aquelina Huanca", ""],
        },
        "appliedInterventions": {
            "items": [
                {
                    "executedSurveys": {
                        "items": [
                            {
                                "executedSurveySurveyId": "a16a5ca4-ae84-43d3-b91c-5ba416743064",
                                "id": "ee05a150-1404-454f-94c3-dd6f456c68a3",
                            },
                            {
                                "executedSurveySurveyId": "7b99f3a5-6136-459d-ac44-0578490da82c",
                                "id": "b59a04ea-d1b3-40bb-a982-52bcc7962772",
                            },
                            {
                                "executedSurveySurveyId": "28ee066e-ea32-403c-b733-c9402a798aca",
                                "id": "193b512e-ab6b-491c-b0e1-d3a4583f48b7",
                            },
                        ]
                    }
                }
            ]
        },
        "parentEntityID": "e6a3a6bf-2072-41df-87d0-d8550ac23447",
        "level": {"id": "f8eebf42-2869-40a9-afab-0a2f429a98a6"},
    },
    {
        "id": "fe81444c-e914-4db9-9bfb-64ba60720d20",
        "name": {
            "languageKeys": ["en-US", "es-BO", "tr-TR"],
            "languageTexts": ["", "Esteban Chayaco Choque", ""],
        },
        "appliedInterventions": {
            "items": [
                {
                    "executedSurveys": {
                        "items": [
                            {
                                "executedSurveySurveyId": "28ee066e-ea32-403c-b733-c9402a798aca",
                                "id": "f705a414-3d82-45a0-8996-d935e4a4ccd1",
                            },
                            {
                                "executedSurveySurveyId": "a16a5ca4-ae84-43d3-b91c-5ba416743064",
                                "id": "afde055f-fb9b-4d93-bfb9-898a095b8dad",
                            },
                        ]
                    }
                }
            ]
        },
        "parentEntityID": "0f802cb6-d149-4f6a-acdf-db24f46ec634",
        "level": {"id": "f8eebf42-2869-40a9-afab-0a2f429a98a6"},
    },
    {
        "id": "eafd0500-c34b-40c1-8b23-74e5cbeb28dc",
        "name": {
            "languageKeys": ["en-US", "es-BO", "tr-TR"],
            "languageTexts": ["", "Tanga Tanga", ""],
        },
        "appliedInterventions": {"items": []},
        "parentEntityID": None,
        "level": {"id": "511ef98b-fd84-4daf-ba08-c0ab501c0b7f"},
    },
]


def filter_parent_entities(filtered_entities, all_entities):
    unique_parent_ids = set(entity["parentEntityID"] for entity in filtered_entities)
    remaining_entities = all_entities.copy()

    while unique_parent_ids:
        new_filtered_entities = []
        new_remaining_entities = []

        for entity in remaining_entities:
            entity_id = entity["id"]
            print(entity_id)
            if entity_id in unique_parent_ids:
                entity_copy = entity.copy()
                entity_copy.pop("appliedInterventions")
                new_filtered_entities.append(entity_copy)
            else:
                new_remaining_entities.append(entity)

        filtered_entities.extend(new_filtered_entities)
        remaining_entities = new_remaining_entities
        unique_parent_ids = set(
            entity["parentEntityID"] for entity in new_filtered_entities
        )

    return filtered_entities


filtered_entites_with_parents = filter_parent_entities(filtered_entites, all_entites)


print(filtered_entites_with_parents)
